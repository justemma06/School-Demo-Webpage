webpackJsonpCoveoForSitecore([7],{17:function(e,t,o){"use strict";var n=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),r=o(1),s=o(5),c=function(e){function t(o,n,s){var c=e.call(this,o,t.ID,s)||this;return c.element=o,c.options=n,c.bindings=s,c.options=i.ComponentOptions.initComponentOptions(o,t,n),c.bind.onRootElement(r.SitecoreContextEvents.onSitecoreContextInitialization,c.afterComponentsInitialization),c}return n(t,e),t.prototype.afterComponentsInitialization=function(e){var t=this;this.root.dataset.coveoForSitecoreEventRegistered||(this.root.dataset.coveoForSitecoreEventRegistered="true",this.bind.onRootElement(i.QueryEvents.buildingQuery,function(o){t.onBuildingQuery(o,e)}))},t.prototype.onBuildingQuery=function(e,t){var o=this.triggerBuildingSitecoreExternalContent(),n=this.triggerBuildingLocalSitecoreInstanceEvent(),r=new i.ExpressionBuilder;n.expression.isEmpty()||r.add(n.expression.build()),o.sources.length>0&&r.addFieldExpression("@syssource","==",o.sources),o.collections.length>0&&r.addFieldExpression("@syscollection","==",o.collections),r.isEmpty()||e.queryBuilder.constantExpression.add(r.build(" OR "));var s=new i.ExpressionBuilder;s.addFieldExpression("@syssource","==",[t.indexSourceName].concat(o.sources)),o.collections.length>0&&s.addFieldExpression("@syscollection","==",o.collections),e.queryBuilder.advancedExpression.add(s.build(" OR "))},t.prototype.triggerBuildingSitecoreExternalContent=function(){var e={sources:[],collections:[]};return this.bind.trigger(this.element,s.SitecoreExpressionEvents.onBuildingSitecoreExternalContent,e),{sources:this.filterUnique(e.sources),collections:this.filterUnique(e.collections)}},t.prototype.triggerBuildingLocalSitecoreInstanceEvent=function(){var e={expression:new i.ExpressionBuilder};return this.bind.trigger(this.element,s.SitecoreExpressionEvents.onBuildingLocalSitecoreInstanceExpression,e),e},t.prototype.filterUnique=function(e){return e.filter(function(e,t,o){return o.indexOf(e)===t})},t.ID="ForSitecoreExpressions",t.options={},t}(i.Component);t.CoveoForSitecoreExpressions=c,i.Initialization.registerAutoCreateComponent(c)}});
//# sourceMappingURL=CoveoForSitecoreExpressions.min.js.map